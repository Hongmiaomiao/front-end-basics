# 小程序基础原理

[toc]

## 官方说明

[文档](https://developers.weixin.qq.com/ebook?action=get_post_info&docid=0006a2289c8bb0bb0086ee8c056c0a)位置较绕，应该在公众平台目录下，不在小程序下

小程序是什么？
看下小程序、h5的区别，看下二者架构
小程序是运行在微信/其他一些平台上的应用，它不像app需要下载，也不像h5每次打开都要拉取很多资源

## 小程序与h5的区别

1. [微信公众平台文档](https://developers.weixin.qq.com/ebook?action=get_post_info&docid=0006a2289c8bb0bb0086ee8c056c0a)
2. [小程序开放文档]（）
3. [掘金文章](https://juejin.cn/post/6844904105882697741)

### 渲染机制 [重点]

1. 小程序的双线程架构
### 运行环境

1. h5运行环境是浏览器，只要用浏览器/webview就可以使用。
2. 小程序就不一样了，它运行于特定的移动软件平台 (微信支付宝等)
它是基于浏览器内核重构的内置解析器，它并不是一个完整的浏览器，官方文档中重点强调了脚本内无法使用浏览器中常用的 window 对象和 document 对象，就是没有 DOM 和 BOM 的相关的 API，这一条就干掉了 JQ 和一些依赖于 BOM 和 DOM 的NPM包

### 运行机制

1. h5每次都是重新去打开加载一个页面，就是我们平时说的url到加载的这个过程
2. 小程序
   - 热启动： 已经打开过小程序，在一段时间内不需要重新启动，只需要把其从后台状态切换到前台
   - 销毁： 小程序进入后台一定时间/系统占用资源过高/手动销毁

### 系统权限(h5总是被诟病的地方)

1. H5最被诟病的地方在哪？系统权限不够，比如网络通信状态、数据缓存能力、通讯录、或调用硬件的，如蓝牙功能等等一些APP有的功能，H5就没有这些系统权限，因为它重度依赖浏览器能力
2. 小程序借助宿主环境，可以完成很多普通网页无法完成的功能。微信客户端的这些系统级权限都可以和微信小程序无缝衔接，官方宣称拥有 Native App 的流畅性能（但是底层的能力都被微信限制了，需要依赖其再封装一层，小程序<app原生）

### 开发成本

1. h5要考虑兼容性
2. 小程序有一些在原生app上需要封装的组件可以直接用、很多兼容性问题小程序已经处理好，按文档操作就好

### 更新机制

1. 主要是小程序的看下官网文档



## rpx与px的、rem、em的区别？

1. px是固定的像素单位
2. rem用于做响应式的页面，rem是全部的长度都相对于根元素即[html]元素。通常做法是给html元素设置一个字体大小(如果是默认情况，一般浏览器是16px)，然后其他元素的长度单位就为rem。(1px是根字体大小的一倍)
=> 基于上面的算法我们反推 当我们设置html的font-size为 (屏幕宽度/设计稿宽度) 的px 时
当我们在设计稿上测得的 px 单位值,直接将值换为 rem单位写到代码里面即可,这点与微信小程序的 rpx 单位适配类似。
3. em的话是相对于父元素的font-size大小。
4. rpx也用于做响应式，在小程序中，（responsive pixel）: 可以根据屏幕宽度进行自适应。微信小程序规定屏幕宽度为750rpx。如在 iPhone6 上，屏幕宽度为375px，共有750个物理像素，则750rpx = 375px = 750物理像素，1rpx = 0.5px = 1物理像素。

## rem是怎么计算的？

[rem计算](https://www.jianshu.com/p/388d0e5683c)

1. rem就是以根元素
2. 以设计稿尺寸为基础，

